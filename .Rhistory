library("phyloseq")
library("ggplot2")      # graphics
library("readxl")       # necessary to import the data from Excel file
library("dplyr")        # filter and reformat data frames
library("tibble")       # Needed for converting column to row names
getwd() # checking file path
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
otu_mat <- otu_mat %>%
tibble::column_to_rownames("PSN") %>%
t() %>%
as.data.frame()
colnames(otu_mat)
otu_mat <- otu_mat %>%
tibble::column_to_rownames("PSN")
rownames(samples_df) <- NULL
tax_mat <- tax_mat %>%
tibble::column_to_rownames("OTU_ID")
samples_df <- samples_df %>%
tibble::column_to_rownames("PSN")
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat)
samples = sample_data(samples_df)
carbom <- phyloseq(OTU, TAX, samples)
carbom
library("phyloseq")
library("ggplot2")      # graphics
library("readxl")       # necessary to import the data from Excel file
library("dplyr")        # filter and reformat data frames
library("tibble")       # Needed for converting column to row names
getwd() # checking file path
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
library("phyloseq")
library("ggplot2")      # graphics
library("readxl")       # necessary to import the data from Excel file
library("dplyr")        # filter and reformat data frames
library("tibble")       # Needed for converting column to row names
getwd() # checking file path
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
rownames(samples_df) <- NULL
if (FALSE) { # attempted OTU troubleshooting
otu_mat <- otu_mat %>%
tibble::column_to_rownames("PSN") %>%
t() %>%
as.data.frame()
colnames(otu_mat)
otu_mat <- otu_mat %>%
tibble::column_to_rownames("PSN")
}
tax_mat <- tax_mat %>%
tibble::column_to_rownames("OTU_ID")
samples_df <- samples_df %>%
tibble::column_to_rownames("PSN")
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat)
samples = sample_data(samples_df)
carbom <- phyloseq(OTU, TAX, samples)
library("phyloseq")
library("ggplot2")      # graphics
library("readxl")       # necessary to import the data from Excel file
library("dplyr")        # filter and reformat data frames
library("tibble")       # Needed for converting column to row names
getwd() # checking file path
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
rownames(samples_df) <- NULL
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
tibble::column_to_rownames("PSN")
library("phyloseq")
library("ggplot2")      # graphics
library("readxl")       # necessary to import the data from Excel file
library("dplyr")        # filter and reformat data frames
library("tibble")       # Needed for converting column to row names
getwd() # checking file path
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
rownames() <- NULL %>%
tibble::column_to_rownames("PSN")
library("phyloseq")
library("ggplot2")      # graphics
library("readxl")       # necessary to import the data from Excel file
library("dplyr")        # filter and reformat data frames
library("tibble")       # Needed for converting column to row names
getwd() # checking file path
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
tibble::rownames_to_column("PSN")
column_to_rownames("PSN")
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
tibble::rownames_to_column("PSN") %>%
column_to_rownames("PSN")
tax_mat <- tax_mat %>%
tibble::column_to_rownames("OTU_ID")
rownames(samples_df) <- NULL
samples_df <- samples_df %>%
tibble::column_to_rownames("PSN")
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
library("phyloseq")
library("ggplot2")      # graphics
library("readxl")       # necessary to import the data from Excel file
library("dplyr")        # filter and reformat data frames
library("tibble")       # Needed for converting column to row names
getwd() # checking file path
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
tibble::rownames_to_column("PSN") %>%
column_to_rownames("PSN")
tax_mat <- tax_mat %>%
tibble::column_to_rownames("OTU_ID")
rownames(samples_df) <- NULL
samples_df <- samples_df %>%
tibble::column_to_rownames("PSN")
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat)
samples = sample_data(samples_df)
carbom <- phyloseq(OTU, TAX, samples)
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
tibble::rownames_to_column("PSN")
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
tibble::rownames_to_column("PSN")
tax_mat <- tax_mat %>%
tibble::column_to_rownames("OTU_ID")
rownames(samples_df) <- NULL
samples_df <- samples_df %>%
tibble::column_to_rownames("PSN")
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
View(otu_mat)
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
otu_mat <- otu_mat %>%
t() %>% # transpose for formatting
as.data.frame() %>%
tibble::column_to_rownames("PSN")
otu_mat<- read.csv("data_sets/HMP_V13_OTU_counts.csv", header = TRUE)
tax_mat<- read.csv("data_sets/HMP_V13_taxonomy_fix.csv", header = TRUE)
samples_df <- read.csv("data_sets/HMP_V13_participant_data.csv", header = TRUE)
View(otu_mat)
View(samples_df)
otu_mat_2 <- otu_mat %>%
tibble::column_to_rownames("PSN") %>%
t() %>% # transpose for formatting
as.data.frame()
View(otu_mat_2)
tax_mat_2 <- tax_mat %>%
tibble::column_to_rownames("OTU_ID")
View(tax_mat_2)
rownames(samples_df) <- NULL
samples_df_2 <- samples_df %>%
tibble::column_to_rownames("PSN")
View(samples_df_2)
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat)
samples = sample_data(samples_df)
carbom <- phyloseq(OTU, TAX, samples)
otu_mat_3 <- as.matrix(otu_mat_2)
tax_mat_3 <- as.matrix(tax_mat_2)
OTU = otu_table(otu_mat_3, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat_3)
samples = sample_data(samples_df_2)
carbom <- phyloseq(OTU, TAX, samples)
View(carbom)
carbom.compositional <- microbiome::transform(carbom, "compositional")
library("microbiome")
BiocManager::install("microbiome")
library("microbiome")
carbom.compositional <- microbiome::transform(carbom, "compositional")
View(carbom.compositional)
list.taxa.passing <- core_members(carbom.compositional, detection = 0, prevalence = 50/100)
list.taxa.passing
View(tax_mat_3)
tax_mat_2 <- tax_mat %>%
mutate(OTU = OTU_ID) %>%
tibble::column_to_rownames("OTU_ID")
tax_mat_2 <- tax_mat %>%
as.data.frame() %>%
mutate(OTU = OTU_ID) %>%
tibble::column_to_rownames("OTU_ID")
View(tax_mat_2)
otu_mat_3 <- as.matrix(otu_mat_2)
tax_mat_3 <- as.matrix(tax_mat_2)
OTU = otu_table(otu_mat_3, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat_3)
samples = sample_data(samples_df_2)
carbom <- phyloseq(OTU, TAX, samples)
carbom
carbom.compositional <- microbiome::transform(carbom, "compositional")
list.taxa.passing <- core_members(carbom.compositional, detection = 0, prevalence = 50/100)
filtered_physeq <- subset_taxa(carbom.compositional, OTU %in% list.taxa.passing)
View(filtered_physeq)
list.taxa.passing <- core_members(carbom.compositional, detection = 0, prevalence = 5/100)
filtered_physeq <- subset_taxa(carbom.compositional, OTU %in% list.taxa.passing)
?
?transform
?transform
